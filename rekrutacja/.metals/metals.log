2021.03.18 11:01:45 INFO  started: Metals version 0.9.0 in workspace '/home/ms/Programming/scala-teaching/rekrutacja'
2021.03.18 11:01:48 INFO  time: initialize in 2.36s
Starting the bsp launcher for bloop...
Opening a bsp server connection with 'bsp --protocol local --socket /tmp/bsp-launcher8715408766474846483/bsp.socket'...
Waiting for the bsp connection to come up...
2021.03.18 11:01:50 INFO  no build target: using presentation compiler with only scala-library
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
2021.03.18 11:01:58 WARN  no build target for: /home/ms/Programming/scala-teaching/rekrutacja/src/main/scala/eu/brosbit/Main.scala
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
No server running at 127.0.0.1:8212, let's fire one...
Resolving ch.epfl.scala:bloop-frontend_2.12:1.4.0-RC1-229-b7c15aa9...
Starting bloop server at 127.0.0.1:8212...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
Attempting a connection to the server...
[0m[32m[D][0m Loading workspace settings from bloop.settings.json
[0m[32m[D][0m Loading 2 projects from '/home/ms/Programming/scala-teaching/rekrutacja/.bloop'...
[0m[32m[D][0m Loading project from '/home/ms/Programming/scala-teaching/rekrutacja/.bloop/root.json'
[0m[32m[D][0m Loading project from '/home/ms/Programming/scala-teaching/rekrutacja/.bloop/root-test.json'
[0m[32m[D][0m Cache miss for scala instance org.scala-lang:scala-compiler:2.13.2.
[0m[32m[D][0m   => /home/ms/.ivy2/cache/net.java.dev.jna/jna/jars/jna-5.3.1.jar
[0m[32m[D][0m   => /home/ms/.ivy2/cache/org.jline/jline/jars/jline-3.14.1.jar
[0m[32m[D][0m   => /home/ms/.ivy2/cache/org.scala-lang/scala-compiler/jars/scala-compiler-2.13.2.jar
[0m[32m[D][0m   => /home/ms/.ivy2/cache/org.scala-lang/scala-library/jars/scala-library-2.13.2.jar
[0m[32m[D][0m   => /home/ms/.ivy2/cache/org.scala-lang/scala-reflect/jars/scala-reflect-2.13.2.jar
[0m[32m[D][0m Configured SemanticDB in projects 'root-test', 'root'
[0m[32m[D][0m Missing analysis file for project 'root-test'
[0m[32m[D][0m Loading previous analysis for 'root' from '/home/ms/Programming/scala-teaching/rekrutacja/target/streams/compile/bloopAnalysisOut/$global/streams/inc_compile_2.13.zip'.
[0m[32m[D][0m Waiting for a connection at local:///tmp/bsp-launcher8715408766474846483/bsp.socket...
The server is listening for incoming connections at local:///tmp/bsp-launcher8715408766474846483/bsp.socket...
Starting thread that pumps stdin and redirects it to the bsp server...
Starting thread that pumps server stdout and redirects it to the client stdout...
2021.03.18 11:02:00 INFO  tracing is disabled for protocol BSP, to enable tracing of incoming and outgoing JSON messages create an empty file at /home/ms/.cache/metals/bsp.trace.json
2021.03.18 11:02:01 INFO  time: connected to build server in 11s
2021.03.18 11:02:01 INFO  Connected to Build server v1.4.0-RC1-229-b7c15aa9
2021.03.18 11:02:01 INFO  time: imported build in 0.27s
2021.03.18 11:02:07 INFO  time: indexed workspace in 5.72s
2021.03.18 11:02:09 INFO  compiling root (2 scala sources)
2021.03.18 11:02:19 WARN  1 deprecation (since 2.13.0); re-run with -deprecation for details
2021.03.18 11:02:19 INFO  time: compiled root in 10s
2021.03.18 11:02:23 INFO  shutting down Metals
No more data in the client stdin, exiting...
No more data in the server stdin, exiting...
No more data in the server stdin, exiting...
[0m2021.04.01 17:06:51 INFO  Started: Metals version 0.10.0 in workspace '/home/ms/Programming/scala-teaching/rekrutacja' for client vscode 1.55.0.[0m
[0m2021.04.01 17:06:54 INFO  time: initialize in 2.37s[0m
[0m2021.04.01 17:06:54 WARN  resetting database: /home/ms/Programming/scala-teaching/rekrutacja/.metals/metals.h2.db[0m
[0m2021.04.01 17:06:55 INFO  Attempting to connect to the build server...[0m
Starting the bsp launcher for bloop...
Opening a bsp server connection with 'bsp --protocol local --socket /tmp/bsp-launcher1206619539247747708/bsp.socket'...
Waiting for the bsp connection to come up...
[0m2021.04.01 17:06:55 WARN  no build target for: /home/ms/Programming/scala-teaching/rekrutacja/src/main/scala/eu/brosbit/Maker.scala[0m
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
[0m2021.04.01 17:07:09 INFO  shutting down Metals[0m
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
error: Giving up on waiting for a connection, printing embedded bloop logs:
> No server running at 127.0.0.1:8212, let's fire one...
> Resolving ch.epfl.scala:bloop-frontend_2.12:1.4.8...
error: Trying a tcp-based connection to the server instead...
Opening a bsp server connection with 'bsp --protocol tcp --port 26529'...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
Waiting for the bsp connection to come up...
error: Giving up on waiting for a connection, printing embedded bloop logs:
> No server running at 127.0.0.1:8212, let's fire one...
> Resolving ch.epfl.scala:bloop-frontend_2.12:1.4.8...
error: The launcher failed to establish a bsp connection, aborting...
[0m2021.04.01 17:07:56 ERROR Failed to connect with build server, no functionality will work.
java.lang.RuntimeException: The server did not start, got FailedToOpenBspConnection
	at bloop.launcher.LauncherMain.failPromise$1(Launcher.scala:95)
	at bloop.launcher.LauncherMain.runLauncher(Launcher.scala:122)
	at scala.meta.internal.metals.BloopServers$$anon$1.run(BloopServers.scala:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.lang.Thread.run(Thread.java:834)
[0m
[0m2021.04.01 17:08:13 INFO  no build target: using presentation compiler with only scala-library: 2.12.13[0m
package eu.brosbit

import java.io.File
import com.github.tototoshi.csv._

object Maker {

  def mkResults(path:String) = {
    val reader = CSVReader.open(new File(path))
    val results = reader.all()
    println(s"Wszystkich na liÅ›cie: ${results.size}")
    //results.foreach(r => if (r(3).trim.isEmpty || r(2).trim.isEmpty) println(r))
    val notApeared = results.filter(r => r(2).isEmpty).map(r => Pupil(r(3), r(0), r(1), 0))
    println(s"Not apeared: ${notApeared.size}")
    val pupils = results
      .filter(r => r(3).trim.nonEmpty && r(2).trim.nonEmpty)
      .map(r => Pupil(r(3), r(0), r(1), r(2).toInt))
    for (p <- pupils) if (p.points <= 0) println(p)
    println(s"Wyniki dla posiadajÄ…cych pesel: ${pupils.size}")
    println( s"Ma wyniki ale nie ma peselu: ${results.size - pupils.size - notApeared.size}")
    pupils
  }

  def mkCandidates(path:String) = {
    val candidatesCsv = CSVReader.open(new File(path))
    val candidatesList= candidatesCsv.all()
    val candidates = candidatesList.map(c => {
      Pupil(c(0), c(1), c(2), -1)
    })
    println(s"IloÅ›Ä‡ kandydatÃ³w: ${candidates.size}")
    candidates
  }

  def macher(results:List[Pupil], candidates: List[Pupil]): List[Pupil] = {
    candidates.map(c => {
        var resOpt = results.find(p => p.pesel == c.pesel)
        resOpt match {
            case None => 
            case Some(p) => c.points = p.points  
        }
        c
    })
  }

  def calculatePassedButNotInCandidates(results:List[Pupil], candidates: List[Pupil]) = {
      results.filter(p => candidates.find(c => c.pesel == p.pesel).isEmpty)
  }

  def mkResultsFromSukFile(path:String) = {
    val reader = CSVReader.open(new File(path))
    val results = reader.all().filter(_.length >= 4)
    println(s"Wszystkich na liÅ›cie: ${results.size}")
    //results.foreach(println)
    //results.foreach(r => if (r(3).trim.isEmpty || r(2).trim.isEmpty) println(r))

    val notAppeared = results.filter(r => r(3).isEmpty).map(r => Pupil(r(0), r(1), r(2), 0, ""))
    println(s"No points: ${notAppeared.size}")
    val pupils = results.filter(r => r(3).trim.nonEmpty)
      .map(r => Pupil(r(0), r(1), r(2), r(3).toInt, ""))

    //for (p <- pupils)  println(p)
    println(s"Wyniki dla posiadajÄ…cych pesel: ${pupils.size}")
    println( s"Ma wyniki ale nie ma peselu: ${results.size - pupils.size - notAppeared.size}")
    pupils++notAppeared
  }

  def mkAccepted(path:String) = {
    val reader = CSVReader.open(new File(path))
    val results = reader.all().filter(_.length >= 4)

    //results.foreach(println)
    //results.foreach(r => if (r(3).trim.isEmpty || r(2).trim.isEmpty) println(r))
    val classInfo = results.map(r => Pupil(r(1), r(2), r(3), 0, r(110).trim))
    println("Wszyscy przyjÄ™ci " + classInfo.length)
    //classInfo.foreach(p => p.classInfo.foreach(l => {print(l); print(" ")}))
    classInfo.map(p => {
      if(p.classInfo(2) == ' '  || p.classInfo(2) == '-') p.classInfo = p.classInfo.substring(0,2)
      else p.classInfo = p.classInfo.substring(9, 11)
      p
    })
  }

  def toFile(path: String, pupils:List[Pupil]) {
    val w = CSVWriter.open(new File(path))
    w.writeAll(pupils.map(_.toList))
    w.close()
  }

}

package eu.brosbit

import java.io.File
import com.github.tototoshi.csv._

object Maker {

  def mkResults(path:String) = {
    val reader = CSVReader.open(new File(path))
    val results = reader.all()
    println(s"Wszystkich na liÅ›cie: ${results.size}")
    //results.foreach(r => if (r(3).trim.isEmpty || r(2).trim.isEmpty) println(r))
    val notApeared = results.filter(r => r(2).isEmpty).map(r => Pupil(r(3), r(0), r(1), 0))
    println(s"Not apeared: ${notApeared.size}")
    val pupils = results
      .filter(r => r(3).trim.nonEmpty && r(2).trim.nonEmpty)
      .map(r => Pupil(r(3), r(0), r(1), r(2).toInt))
    for (p <- pupils) if (p.points <= 0) println(p)
    println(s"Wyniki dla posiadajÄ…cych pesel: ${pupils.size}")
    println( s"Ma wyniki ale nie ma peselu: ${results.size - pupils.size - notApeared.size}")
    pupils
  }

  def mkCandidates(path:String) = {
    val candidatesCsv = CSVReader.open(new File(path))
    val candidatesList= candidatesCsv.all()
    val candidates = candidatesList.map(c => {
      Pupil(c(0), c(1), c(2), -1)
    })
    println(s"IloÅ›Ä‡ kandydatÃ³w: ${candidates.size}")
    candidates
  }

  def macher(results:List[Pupil], candidates: List[Pupil]): List[Pupil] = {
    candidates.map(c => {
        var resOpt = results.find(p => p.pesel == c.pesel)
        resOpt match {
            case None => 
            case Some(p) => c.points = p.points  
        }
        c
    })
  }

  def calculatePassedButNotInCandidates(results:List[Pupil], candidates: List[Pupil]) = {
      results.filter(p => candidates.find(c => c.pesel == p.pesel).isEmpty)
  }

  def mkResultsFromSukFile(path:String) = {
    val reader = CSVReader.open(new File(path))
    val results = reader.all().filter(_.length >= 4)
    println(s"Wszystkich na liÅ›cie: ${results.size}")
    //results.foreach(println)
    //results.foreach(r => if (r(3).trim.isEmpty || r(2).trim.isEmpty) println(r))

    val notAppeared = results.filter(r => r(3).isEmpty).map(r => Pupil(r(0), r(1), r(2), 0, ""))
    println(s"No points: ${notAppeared.size}")
    val pupils = results.filter(r => r(3).trim.nonEmpty)
      .map(r => Pupil(r(0), r(1), r(2), r(3).toInt, ""))

    //for (p <- pupils)  println(p)
    println(s"Wyniki dla posiadajÄ…cych pesel: ${pupils.size}")
    println( s"Ma wyniki ale nie ma peselu: ${results.size - pupils.size - notAppeared.size}")
    pupils++notAppeared
  }

  def mkAccepted(path:String) = {
    val reader = CSVReader.open(new File(path))
    val results = reader.all().filter(_.length >= 4)

    //results.foreach(println)
    //results.foreach(r => if (r(3).trim.isEmpty || r(2).trim.isEmpty) println(r))
    val classInfo = results.map(r => Pupil(r(1), r(2), r(3), 0, r(110).trim))
    println("Wszyscy przyjÄ™ci " + classInfo.length)
    //classInfo.foreach(p => p.classInfo.foreach(l => {print(l); print(" ")}))
    classInfo.map(p => {
      if(p.classInfo(2) == ' '  || p.classInfo(2) == '-') p.classInfo = p.classInfo.substring(0,2)
      else p.classInfo = p.classInfo.substring(9, 11)
      p
    })
  }

  def toFile(path: String, pupils:List[Pupil]) {
    val w = CSVWriter.open(new File(path))
    w.writeAll(pupils.map(_.toList))
    w.close()
  }

}

[0m2021.04.01 17:08:19 INFO  time: code lens generation in 1m24s[0m
java.util.concurrent.RejectedExecutionException: Task scala.concurrent.impl.CallbackRunnable@59233e4f rejected from java.util.concurrent.ThreadPoolExecutor@6333378f[Shutting down, pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 63]
	at java.base/java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:2055)
	at java.base/java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:825)
	at java.base/java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:1355)
	at scala.concurrent.impl.ExecutionContextImpl$$anon$4.execute(ExecutionContextImpl.scala:138)
	at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:72)
	at scala.concurrent.impl.Promise$DefaultPromise.$anonfun$tryComplete$1(Promise.scala:288)
	at scala.concurrent.impl.Promise$DefaultPromise.$anonfun$tryComplete$1$adapted(Promise.scala:288)
	at scala.concurrent.impl.Promise$DefaultPromise.tryComplete(Promise.scala:288)
	at scala.concurrent.Promise.complete(Promise.scala:53)
	at scala.concurrent.Promise.complete$(Promise.scala:52)
	at scala.concurrent.impl.Promise$DefaultPromise.complete(Promise.scala:187)
	at scala.concurrent.impl.Promise.$anonfun$transform$1(Promise.scala:33)
	at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:64)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
